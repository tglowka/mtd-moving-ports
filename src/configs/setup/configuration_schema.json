{
  "type": "object",
  "properties": {
    "redis_client_configuration": {
      "type": "object",
      "properties": {
        "host": {
          "type": "string"
        },
        "port": {
          "type": "integer"
        },
        "db": {
          "type": "integer"
        },
        "charset": {
          "type": "string"
        },
        "decode_responses": {
          "type": "boolean"
        }
      },
      "required": ["host", "port", "db", "charset", "decode_responses"]
    },
    "redis_subscriber_configuration": {
      "type": "object",
      "properties": {
        "subscriber_channel_names": {
          "type": "array"
        }
      },
      "required": ["subscriber_channel_names"]
    },
    "mtd_controller_configuration": {
      "type": "object",
      "properties": {
        "nft_startup_script_path": {
          "type": "string"
        },
        "nft_address_rules_script_path": {
          "type": "string"
        },
        "max_port_number": {
          "type": "number"
        },
        "all_used_ports": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "port": {
                "type": "number"
              },
              "protocol": {
                "type": "string"
              }
            },
            "required": ["port", "protocol"]
          }
        },
        "watched_addresses": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "address": {
                "type": "string"
              },
              "ports_to_ignore": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "port": {
                      "type": "number"
                    },
                    "protocol": {
                      "type": "string"
                    }
                  },
                  "required": ["port", "protocol"]
                }
              }
            },
            "required": ["address", "ports_to_ignore"]
          }
        }
      },
      "required": [
        "nft_startup_script_path",
        "nft_address_rules_script_path",
        "max_port_number",
        "all_used_ports",
        "watched_addresses"
      ]
    }
  },
  "required": [
    "redis_client_configuration",
    "redis_subscriber_configuration",
    "mtd_controller_configuration"
  ]
}
